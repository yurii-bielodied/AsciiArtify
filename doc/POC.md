# GitOps PoC –∑ Argo CD –Ω–∞ k3d –¥–ª—è —Å—Ç–∞—Ä—Ç–∞–ø—É **AsciiArtify**

---

## 0. –¶—ñ–ª—ñ PoC

–ù–∞ –µ—Ç–∞–ø—ñ Proof of Concept –º–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ:

1. **–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π Kubernetes (k3d)** –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —è–∫ –±–∞–∑—É –¥–ª—è GitOps-–ø—ñ–¥—Ö–æ–¥—É.
2. **Argo CD** —É—Å–ø—ñ—à–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –≤ –∫–ª–∞—Å—Ç–µ—Ä k3d.
3. –ö–æ–º–∞–Ω–¥–∞ —Ä–æ–∑—Ä–æ–±–∫–∏ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **–¥–æ—Å—Ç—É–ø –¥–æ –≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É Argo CD** —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –¥–µ–ø–ª–æ—î–º –¥–æ–¥–∞—Ç–∫—ñ–≤.
4. –Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ –ø–æ–¥–∞–ª—å—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–æ —Ä—ñ–≤–Ω—è MVP (—Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Å–∞–º–æ–≥–æ AsciiArtify —Ç–∞ —Å—É–ø—É—Ç–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤).

---

## 1. –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

### 1.1. –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

–ù–∞ —Ä–æ–±–æ—á—ñ–π –º–∞—à–∏–Ω—ñ / —Å–µ—Ä–≤–µ—Ä—ñ –º–∞—é—Ç—å –±—É—Ç–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ:

- **Docker Engine**
- **k3d**
- **kubectl**
- (–æ–ø—Ü—ñ–π–Ω–æ) **git** –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è–º–∏ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤

–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∑—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Docker, k3d —Ç–∞ kubectl –Ω–∞–≤–µ–¥–µ–Ω—ñ —É —Ñ–∞–π–ª—ñ [`doc/Concept.md`](./Concept.md) (—Ä–æ–∑–¥—ñ–ª *5.0. –ü–µ—Ä–µ–¥—É–º–æ–≤–∏*).

### 1.2. –í–∏—Ö—ñ–¥–Ω—ñ —É–º–æ–≤–∏

- –ü—Ä–∞—Ü—é—î–º–æ –Ω–∞ Linux (–∞–±–æ WSL2 / Docker Desktop –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é Linux-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤).
- –Ñ –¥–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ —Ç–∞ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤.
- –£—Å—ñ –∫–æ–º–∞–Ω–¥–∏ –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –ø—Ä–∞–≤–∞–º–∏ `sudo` (–¥–µ —Ü–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ).

---

## 2. –î–µ–º–æ-—ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –¥–ª—è –∫–æ–º–∞–Ω–¥–∏ AsciiArtify

–ù–∏–∂—á–µ ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π, —è–∫–∏–π –º–æ–∂–Ω–∞ –¥–∞—Ç–∏ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞–º, —â–æ–± –∫–æ–∂–µ–Ω —ñ–∑ –Ω–∏—Ö –∑–º—ñ–≥:

- –ø—ñ–¥–Ω—è—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π –∫–ª–∞—Å—Ç–µ—Ä k3d;
- –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Argo CD;
- –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.

### 2.1. –ö—Ä–æ–∫ 1 ‚Äî –∫–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π

```bash
git clone https://github.com/yurii-bielodied/AsciiArtify.git
cd AsciiArtify
```

### 2.2. –ö—Ä–æ–∫ 2 ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä k3d –¥–ª—è GitOps

```bash
k3d cluster create asciiartify-gitops \
  --servers 1 \
  --agents 2 \
  --wait
```

–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –∫–ª–∞—Å—Ç–µ—Ä –¥–æ—Å—Ç—É–ø–Ω–∏–π:

```bash
kubectl cluster-info
kubectl get nodes
```

–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî 1 `server` —ñ 2 `agent`-–Ω–æ–¥–∏ –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º `Ready`.

> üîé –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º `k3d` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–ø–∏—Å—É—î –∫–æ–Ω—Ç–µ–∫—Å—Ç `kubeconfig`, —Ç–æ–º—É –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ.

### 2.3. –ö—Ä–æ–∫ 3 ‚Äî –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Argo CD —É –∫–ª–∞—Å—Ç–µ—Ä

### 2.3.1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è namespace `argocd`

```bash
kubectl create namespace argocd
```

### 2.3.2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Argo CD —á–µ—Ä–µ–∑ –æ—Ñ—ñ—Ü—ñ–π–Ω—ñ –º–∞–Ω—ñ—Ñ–µ—Å—Ç–∏

–ó–∞—Å—Ç–æ—Å–æ–≤—É—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –º–∞–Ω—ñ—Ñ–µ—Å—Ç –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è:

```bash
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
```

–ü–µ—Ä–µ–≤—ñ—Ä—è—é, —â–æ –≤—Å—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ Argo CD —Å—Ç–∞—Ä—Ç—É–≤–∞–ª–∏:

```bash
kubectl get pods -n argocd
```

–û—á—ñ–∫—É—î–º–æ –ø–æ–±–∞—á–∏—Ç–∏ –ø–æ–¥–∏ –Ω–∞ –∫—à—Ç–∞–ª—Ç:

- `argocd-server-xxxxx`
- `argocd-repo-server-xxxxx`
- `argocd-application-controller-xxxxx`
- `argocd-dex-server-xxxxx`
- `argocd-redis-xxxxx`

–£—Å—ñ –º–∞—é—Ç—å –±—É—Ç–∏ –≤ —Å—Ç–∞—Ç—É—Å—ñ `Running`.

### 2.4. –ö—Ä–æ–∫ 4 ‚Äî –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É Argo CD

### 2.4.1. –î–æ—Å—Ç—É–ø –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–µ–º–æ (—á–µ—Ä–µ–∑ `kubectl port-forward`)

–î–ª—è PoC —ñ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç ‚Äî **port-forward**.

–£ –æ–∫—Ä–µ–º–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ:

```bash
kubectl port-forward svc/argocd-server -n argocd 8080:443
```

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é:

- **URL:** `https://localhost:8080`

–ë—Ä–∞—É–∑–µ—Ä, —à–≤–∏–¥—à–µ –∑–∞ –≤—Å–µ, –ø–æ–∫–∞–∂–µ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –ø—Ä–æ self-signed —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç ‚Äî –π–æ–≥–æ –º–æ–∂–Ω–∞ **–ø—Ä–æ—ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ –¥–ª—è PoC** (–ø–µ—Ä–µ–π—Ç–∏, –ø—Ä–∏–π–Ω—è–≤—à–∏ —Ä–∏–∑–∏–∫).

### 2.5. –ö—Ä–æ–∫ 5 ‚Äî –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –ø–∞—Ä–æ–ª—å `admin`

Argo CD –≥–µ–Ω–µ—Ä—É—î –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –ø–∞—Ä–æ–ª—å –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ `admin` —É —Å–µ–∫—Ä–µ—Ç—ñ `argocd-initial-admin-secret`.

–û—Ç—Ä–∏–º—É—é –π–æ–≥–æ –∫–æ–º–∞–Ω–¥–æ—é:

```bash
kubectl -n argocd get secret argocd-initial-admin-secret \
  -o jsonpath="{.data.password}" | base64 -d && echo
```

–†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî —Ä—è–¥–æ–∫ —ñ–∑ –ø–∞—Ä–æ–ª–µ–º, —è–∫–∏–π –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è –ø–µ—Ä—à–æ–≥–æ –≤—Ö–æ–¥—É.

### 2.6. –ö—Ä–æ–∫ 6 ‚Äî –ø–µ—Ä—à–∏–π –ª–æ–≥—ñ–Ω —É Argo CD

1. –í—ñ–¥–∫—Ä–∏–π —É –±—Ä–∞—É–∑–µ—Ä—ñ:

   ```text
   https://localhost:8080
   ```

2. –ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –ª–æ–≥—ñ–Ω—É:

   - **Username:** `admin`
   - **Password:** (—Ä—è–¥–æ–∫, –æ—Ç—Ä–∏–º–∞–Ω–∏–π –∑ –∫–æ–º–∞–Ω–¥–∏ –≤–∏—â–µ)

3. –ü—ñ—Å–ª—è –≤—Ö–æ–¥—É –æ–¥—Ä–∞–∑—É **–∑–º—ñ–Ω–∏ –ø–∞—Ä–æ–ª—å** (Settings ‚Üí Account ‚Üí Change password), —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–µ—Ñ–æ–ª—Ç–Ω–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.

–ù–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ **GitOps-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è PoC –≤–≤–∞–∂–∞—î—Ç—å—Å—è —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ—é**: Argo CD –ø—ñ–¥‚Äô—î–¥–Ω–∞–Ω–æ –¥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞, –¥–æ—Å—Ç—É–ø –¥–æ UI –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ.

---

## 3. (–û–ø—Ü—ñ–π–Ω–æ) –ü—Ä–æ—Å—Ç–∏–π GitOps-–¥–µ–ø–ª–æ–π –¥–µ–º–æ-–¥–æ–¥–∞—Ç–∫—É

–¶–µ–π –ø—É–Ω–∫—Ç –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ–≥–æ, —â–æ Argo CD –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ.

### 3.1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è namespace –¥–ª—è –¥–µ–º–æ-–¥–æ–¥–∞—Ç–∫—É

```bash
kubectl create namespace asciiartify-demo
```

### 6.2. –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–µ–º–æ-–¥–æ–¥–∞—Ç–∫—É —á–µ—Ä–µ–∑ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. –£ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ Argo CD –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ **`+ New App`**.
2. –ó–∞–ø–æ–≤–Ω–∏—Ç–∏ –ø–æ–ª—è (–ø—Ä–∏–∫–ª–∞–¥):

   - **Application Name:** `guestbook`
   - **Project:** `default`
   - **Sync Policy:** `Manual` (–¥–ª—è PoC –¥–æ—Å—Ç–∞—Ç–Ω—å–æ)
   - **Repository URL:** `https://github.com/argoproj/argocd-example-apps`
   - **Revision:** `HEAD`
   - **Path:** `guestbook`

   **DESTINATION:**

   - **Cluster URL:** `https://kubernetes.default.svc`
   - **Namespace:** `asciiartify-demo`

3. –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ **Create**.

4. –ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –¥–æ–¥–∞—Ç–∫—É –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏:

   - **Sync** ‚Üí **Synchronize**, —â–æ–± Argo CD –∑–∞—Å—Ç–æ—Å—É–≤–∞–≤ –º–∞–Ω—ñ—Ñ–µ—Å—Ç–∏.

5. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä—ñ:

   ```bash
   kubectl get pods -n asciiartify-demo
   kubectl get svc -n asciiartify-demo
   ```

–ü–æ—è–≤–∞ pod‚Äô—ñ–≤ –¥–µ–º–æ-–¥–æ–¥–∞—Ç–∫–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î, —â–æ GitOps-–ª–∞–Ω—Ü—é–∂–æ–∫ (repo ‚Üí Argo CD ‚Üí –∫–ª–∞—Å—Ç–µ—Ä) –ø—Ä–∞—Ü—é—î.

---

## 4. –ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–æ MVP

–ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–ø–∏—Å–∞–Ω–∏—Ö –∫—Ä–æ–∫—ñ–≤ –º–∏ –º–∞—î–º–æ:

- –ü—Ä–∞—Ü—é—é—á–∏–π –∫–ª–∞—Å—Ç–µ—Ä k3d `asciiartify-gitops`.
- –†–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–π Argo CD —É namespace `argocd`.
- –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É Argo CD –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤.
- –ü—Ä–∏–∫–ª–∞–¥ GitOps-–¥–µ–ø–ª–æ—é –¥–µ–º–æ-–¥–æ–¥–∞—Ç–∫—É.

–î–∞–ª—ñ –¥–ª—è **MVP AsciiArtify** –º–∏ –º–æ–∂–µ–º–æ:

1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –æ–∫—Ä–µ–º–∏–π Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π/–¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –∑ Kubernetes-–º–∞–Ω—ñ—Ñ–µ—Å—Ç–∞–º–∏ / Helm-—á–∞—Ä—Ç–∞–º–∏ —Å–µ—Ä–≤—ñ—Å—ñ–≤ AsciiArtify.
2. –î–æ–¥–∞—Ç–∏ –æ–¥–∏–Ω –∞–±–æ –∫—ñ–ª—å–∫–∞ **Application** –≤ Argo CD, —è–∫—ñ —Å–ª—ñ–¥–∫—É–≤–∞—Ç–∏–º—É—Ç—å –∑–∞ —Ü–∏–º–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è–º–∏.
3. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π sync (–∞–≤—Ç–æ–¥–µ–ø–ª–æ–π) —ñ–∑ Git —É –∫–ª–∞—Å—Ç–µ—Ä.

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ GitOps-—Å–∏—Å—Ç–µ–º–∞ –Ω–∞ –±–∞–∑—ñ Argo CD **–≥–æ—Ç–æ–≤–∞ –¥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó MVP AsciiArtify**.
